<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pursuit.noteblog.dao.UserDao">
	<sql id="user_columns">
		uid,email ,password,nickname,createtime,type,avatar,status
	</sql>
	<sql id="user_fields">
        #{uid},#{email},#{password},#{nickname},#{createtime},#{type},#{avatar},#{status}
    </sql>
	
	
	<select id="getUserById" resultType="com.pursuit.noteblog.entity.User">
		select
		<include refid="user_columns" />
		from user where uid=#{uid}
	</select>
    <!--获取所有用户信息-->
    <select id="getAllUser" resultType="com.pursuit.noteblog.entity.User">
        select
        <include refid="user_columns"/>
        from user where status ='1'
    </select>
    <!-- 根据条件查询用户 -->
    <select id="getUserByCondition" resultType="com.pursuit.noteblog.entity.User">
        select
        <include refid="user_columns"/>
        from user where
        1=1
        <if test="email!= null">and email=#{email}</if>
        <if test="password != null">and password=#{password}</if>
        <if test="nickname != null">and nickname=#{nickname}</if>
        <if test="createtime != null">and createtime=#{createtime}</if>
        <if test="type != null">and type=#{type}</if>
        <if test="avatar != null">and avatar=#{avatar}</if>
        <if test="status != null">and status=#{status}</if>
    </select>
    <!-- 添加用户信息 -->
    <insert id="addUser" parameterType="com.pursuit.noteblog.entity.User">
        insert into user
          (<include refid="user_columns"/>)
        values
          (<include refid="user_fields"/>)
    </insert>
	<update id="updateUser">
		update user
		set
        <if test="email!= null">email=#{email},</if>
        <if test="password != null">password=#{password},</if>
        <if test="nickname != null">nickname=#{nickname},</if>
        <if test="createtime != null">createtime=#{createtime},</if>
        <if test="type != null">type=#{type},</if>
        <if test="avatar != null">avatar=#{avatar},</if>
        <if test="status != null">status=#{status},</if>
        status=#{status}
        where
        uid=#{uid}
	</update>
    <delete id="deleteUserById" >
    	delete from user where uid=#{uid}
    </delete>
    <update id="deleteUser" parameterType="com.pursuit.noteblog.entity.User">
    	update user set status="0" where uid=#{uid}
    </update>
</mapper>